// Code generated by the Pulumi Terraform Bridge (tfgen) Tool DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package launchdarkly

import (
	"context"
	"reflect"

	"github.com/pkg/errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Provides a LaunchDarkly environment-specific feature flag resource.
//
// This resource allows you to create and manage environment-specific feature flags attributes within your LaunchDarkly organization.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/lbrlabs/pulumi-launchdarkly/sdk/go/launchdarkly"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := launchdarkly.NewFeatureFlagEnvironment(ctx, "numberEnv", &launchdarkly.FeatureFlagEnvironmentArgs{
//				FlagId: pulumi.Any(launchdarkly_feature_flag.Number.Id),
//				EnvKey: pulumi.Any(launchdarkly_environment.Staging.Key),
//				On:     pulumi.Bool(true),
//				Prerequisites: launchdarkly.FeatureFlagEnvironmentPrerequisiteArray{
//					&launchdarkly.FeatureFlagEnvironmentPrerequisiteArgs{
//						FlagKey:   pulumi.Any(launchdarkly_feature_flag.Basic.Key),
//						Variation: pulumi.Int(0),
//					},
//				},
//				Targets: launchdarkly.FeatureFlagEnvironmentTargetArray{
//					&launchdarkly.FeatureFlagEnvironmentTargetArgs{
//						Values: pulumi.StringArray{
//							pulumi.String("user0"),
//						},
//						Variation: pulumi.Int(0),
//					},
//					&launchdarkly.FeatureFlagEnvironmentTargetArgs{
//						Values: pulumi.StringArray{
//							pulumi.String("user1"),
//							pulumi.String("user2"),
//						},
//						Variation: pulumi.Int(1),
//					},
//				},
//				Rules: launchdarkly.FeatureFlagEnvironmentRuleArray{
//					&launchdarkly.FeatureFlagEnvironmentRuleArgs{
//						Clauses: launchdarkly.FeatureFlagEnvironmentRuleClauseArray{
//							&launchdarkly.FeatureFlagEnvironmentRuleClauseArgs{
//								Attribute: pulumi.String("country"),
//								Op:        pulumi.String("startsWith"),
//								Values: pulumi.StringArray{
//									pulumi.String("aus"),
//									pulumi.String("de"),
//									pulumi.String("united"),
//								},
//								Negate: pulumi.Bool(false),
//							},
//							&launchdarkly.FeatureFlagEnvironmentRuleClauseArgs{
//								Attribute: pulumi.String("segmentMatch"),
//								Op:        pulumi.String("segmentMatch"),
//								Values: pulumi.StringArray{
//									launchdarkly_segment.Example.Key,
//								},
//								Negate: pulumi.Bool(false),
//							},
//						},
//						Variation: pulumi.Int(0),
//					},
//				},
//				Fallthrough: &launchdarkly.FeatureFlagEnvironmentFallthroughArgs{
//					RolloutWeights: pulumi.IntArray{
//						pulumi.Int(60000),
//						pulumi.Int(40000),
//						pulumi.Int(0),
//					},
//				},
//				OffVariation: pulumi.Int(2),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// LaunchDarkly feature flag environments can be imported using the resource's ID in the form `project_key/env_key/flag_key`, e.g.
//
// ```sh
//
//	$ pulumi import launchdarkly:index/featureFlagEnvironment:FeatureFlagEnvironment example example-project/example-env/example-flag-key
//
// ```
type FeatureFlagEnvironment struct {
	pulumi.CustomResourceState

	// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
	EnvKey pulumi.StringOutput `pulumi:"envKey"`
	// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
	Fallthrough FeatureFlagEnvironmentFallthroughOutput `pulumi:"fallthrough"`
	// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
	FlagId pulumi.StringOutput `pulumi:"flagId"`
	// The index of the variation to serve if targeting is disabled.
	OffVariation pulumi.IntOutput `pulumi:"offVariation"`
	// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
	On pulumi.BoolPtrOutput `pulumi:"on"`
	// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
	Prerequisites FeatureFlagEnvironmentPrerequisiteArrayOutput `pulumi:"prerequisites"`
	// List of logical targeting rules. To learn more, read Nested Rules Blocks.
	Rules FeatureFlagEnvironmentRuleArrayOutput `pulumi:"rules"`
	// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
	Targets FeatureFlagEnvironmentTargetArrayOutput `pulumi:"targets"`
	// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
	TrackEvents pulumi.BoolPtrOutput `pulumi:"trackEvents"`
}

// NewFeatureFlagEnvironment registers a new resource with the given unique name, arguments, and options.
func NewFeatureFlagEnvironment(ctx *pulumi.Context,
	name string, args *FeatureFlagEnvironmentArgs, opts ...pulumi.ResourceOption) (*FeatureFlagEnvironment, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.EnvKey == nil {
		return nil, errors.New("invalid value for required argument 'EnvKey'")
	}
	if args.Fallthrough == nil {
		return nil, errors.New("invalid value for required argument 'Fallthrough'")
	}
	if args.FlagId == nil {
		return nil, errors.New("invalid value for required argument 'FlagId'")
	}
	if args.OffVariation == nil {
		return nil, errors.New("invalid value for required argument 'OffVariation'")
	}
	opts = pkgResourceDefaultOpts(opts)
	var resource FeatureFlagEnvironment
	err := ctx.RegisterResource("launchdarkly:index/featureFlagEnvironment:FeatureFlagEnvironment", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetFeatureFlagEnvironment gets an existing FeatureFlagEnvironment resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetFeatureFlagEnvironment(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *FeatureFlagEnvironmentState, opts ...pulumi.ResourceOption) (*FeatureFlagEnvironment, error) {
	var resource FeatureFlagEnvironment
	err := ctx.ReadResource("launchdarkly:index/featureFlagEnvironment:FeatureFlagEnvironment", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering FeatureFlagEnvironment resources.
type featureFlagEnvironmentState struct {
	// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
	EnvKey *string `pulumi:"envKey"`
	// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
	Fallthrough *FeatureFlagEnvironmentFallthrough `pulumi:"fallthrough"`
	// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
	FlagId *string `pulumi:"flagId"`
	// The index of the variation to serve if targeting is disabled.
	OffVariation *int `pulumi:"offVariation"`
	// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
	On *bool `pulumi:"on"`
	// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
	Prerequisites []FeatureFlagEnvironmentPrerequisite `pulumi:"prerequisites"`
	// List of logical targeting rules. To learn more, read Nested Rules Blocks.
	Rules []FeatureFlagEnvironmentRule `pulumi:"rules"`
	// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
	Targets []FeatureFlagEnvironmentTarget `pulumi:"targets"`
	// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
	TrackEvents *bool `pulumi:"trackEvents"`
}

type FeatureFlagEnvironmentState struct {
	// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
	EnvKey pulumi.StringPtrInput
	// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
	Fallthrough FeatureFlagEnvironmentFallthroughPtrInput
	// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
	FlagId pulumi.StringPtrInput
	// The index of the variation to serve if targeting is disabled.
	OffVariation pulumi.IntPtrInput
	// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
	On pulumi.BoolPtrInput
	// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
	Prerequisites FeatureFlagEnvironmentPrerequisiteArrayInput
	// List of logical targeting rules. To learn more, read Nested Rules Blocks.
	Rules FeatureFlagEnvironmentRuleArrayInput
	// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
	Targets FeatureFlagEnvironmentTargetArrayInput
	// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
	TrackEvents pulumi.BoolPtrInput
}

func (FeatureFlagEnvironmentState) ElementType() reflect.Type {
	return reflect.TypeOf((*featureFlagEnvironmentState)(nil)).Elem()
}

type featureFlagEnvironmentArgs struct {
	// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
	EnvKey string `pulumi:"envKey"`
	// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
	Fallthrough FeatureFlagEnvironmentFallthrough `pulumi:"fallthrough"`
	// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
	FlagId string `pulumi:"flagId"`
	// The index of the variation to serve if targeting is disabled.
	OffVariation int `pulumi:"offVariation"`
	// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
	On *bool `pulumi:"on"`
	// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
	Prerequisites []FeatureFlagEnvironmentPrerequisite `pulumi:"prerequisites"`
	// List of logical targeting rules. To learn more, read Nested Rules Blocks.
	Rules []FeatureFlagEnvironmentRule `pulumi:"rules"`
	// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
	Targets []FeatureFlagEnvironmentTarget `pulumi:"targets"`
	// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
	TrackEvents *bool `pulumi:"trackEvents"`
}

// The set of arguments for constructing a FeatureFlagEnvironment resource.
type FeatureFlagEnvironmentArgs struct {
	// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
	EnvKey pulumi.StringInput
	// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
	Fallthrough FeatureFlagEnvironmentFallthroughInput
	// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
	FlagId pulumi.StringInput
	// The index of the variation to serve if targeting is disabled.
	OffVariation pulumi.IntInput
	// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
	On pulumi.BoolPtrInput
	// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
	Prerequisites FeatureFlagEnvironmentPrerequisiteArrayInput
	// List of logical targeting rules. To learn more, read Nested Rules Blocks.
	Rules FeatureFlagEnvironmentRuleArrayInput
	// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
	Targets FeatureFlagEnvironmentTargetArrayInput
	// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
	TrackEvents pulumi.BoolPtrInput
}

func (FeatureFlagEnvironmentArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*featureFlagEnvironmentArgs)(nil)).Elem()
}

type FeatureFlagEnvironmentInput interface {
	pulumi.Input

	ToFeatureFlagEnvironmentOutput() FeatureFlagEnvironmentOutput
	ToFeatureFlagEnvironmentOutputWithContext(ctx context.Context) FeatureFlagEnvironmentOutput
}

func (*FeatureFlagEnvironment) ElementType() reflect.Type {
	return reflect.TypeOf((**FeatureFlagEnvironment)(nil)).Elem()
}

func (i *FeatureFlagEnvironment) ToFeatureFlagEnvironmentOutput() FeatureFlagEnvironmentOutput {
	return i.ToFeatureFlagEnvironmentOutputWithContext(context.Background())
}

func (i *FeatureFlagEnvironment) ToFeatureFlagEnvironmentOutputWithContext(ctx context.Context) FeatureFlagEnvironmentOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FeatureFlagEnvironmentOutput)
}

// FeatureFlagEnvironmentArrayInput is an input type that accepts FeatureFlagEnvironmentArray and FeatureFlagEnvironmentArrayOutput values.
// You can construct a concrete instance of `FeatureFlagEnvironmentArrayInput` via:
//
//	FeatureFlagEnvironmentArray{ FeatureFlagEnvironmentArgs{...} }
type FeatureFlagEnvironmentArrayInput interface {
	pulumi.Input

	ToFeatureFlagEnvironmentArrayOutput() FeatureFlagEnvironmentArrayOutput
	ToFeatureFlagEnvironmentArrayOutputWithContext(context.Context) FeatureFlagEnvironmentArrayOutput
}

type FeatureFlagEnvironmentArray []FeatureFlagEnvironmentInput

func (FeatureFlagEnvironmentArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*FeatureFlagEnvironment)(nil)).Elem()
}

func (i FeatureFlagEnvironmentArray) ToFeatureFlagEnvironmentArrayOutput() FeatureFlagEnvironmentArrayOutput {
	return i.ToFeatureFlagEnvironmentArrayOutputWithContext(context.Background())
}

func (i FeatureFlagEnvironmentArray) ToFeatureFlagEnvironmentArrayOutputWithContext(ctx context.Context) FeatureFlagEnvironmentArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FeatureFlagEnvironmentArrayOutput)
}

// FeatureFlagEnvironmentMapInput is an input type that accepts FeatureFlagEnvironmentMap and FeatureFlagEnvironmentMapOutput values.
// You can construct a concrete instance of `FeatureFlagEnvironmentMapInput` via:
//
//	FeatureFlagEnvironmentMap{ "key": FeatureFlagEnvironmentArgs{...} }
type FeatureFlagEnvironmentMapInput interface {
	pulumi.Input

	ToFeatureFlagEnvironmentMapOutput() FeatureFlagEnvironmentMapOutput
	ToFeatureFlagEnvironmentMapOutputWithContext(context.Context) FeatureFlagEnvironmentMapOutput
}

type FeatureFlagEnvironmentMap map[string]FeatureFlagEnvironmentInput

func (FeatureFlagEnvironmentMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*FeatureFlagEnvironment)(nil)).Elem()
}

func (i FeatureFlagEnvironmentMap) ToFeatureFlagEnvironmentMapOutput() FeatureFlagEnvironmentMapOutput {
	return i.ToFeatureFlagEnvironmentMapOutputWithContext(context.Background())
}

func (i FeatureFlagEnvironmentMap) ToFeatureFlagEnvironmentMapOutputWithContext(ctx context.Context) FeatureFlagEnvironmentMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FeatureFlagEnvironmentMapOutput)
}

type FeatureFlagEnvironmentOutput struct{ *pulumi.OutputState }

func (FeatureFlagEnvironmentOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**FeatureFlagEnvironment)(nil)).Elem()
}

func (o FeatureFlagEnvironmentOutput) ToFeatureFlagEnvironmentOutput() FeatureFlagEnvironmentOutput {
	return o
}

func (o FeatureFlagEnvironmentOutput) ToFeatureFlagEnvironmentOutputWithContext(ctx context.Context) FeatureFlagEnvironmentOutput {
	return o
}

// The environment key. A change in this field will force the destruction of the existing resource and the creation of a new one.
func (o FeatureFlagEnvironmentOutput) EnvKey() pulumi.StringOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) pulumi.StringOutput { return v.EnvKey }).(pulumi.StringOutput)
}

// - (Required) Nested block describing the default variation to serve if no `prerequisites`, `target`, or `rules` apply.To learn more, read Nested Fallthrough Block.
func (o FeatureFlagEnvironmentOutput) Fallthrough() FeatureFlagEnvironmentFallthroughOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) FeatureFlagEnvironmentFallthroughOutput { return v.Fallthrough }).(FeatureFlagEnvironmentFallthroughOutput)
}

// The feature flag's unique `id` in the format `project_key/flag_key`. A change in this field will force the destruction of the existing resource and the creation of a new one.
func (o FeatureFlagEnvironmentOutput) FlagId() pulumi.StringOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) pulumi.StringOutput { return v.FlagId }).(pulumi.StringOutput)
}

// The index of the variation to serve if targeting is disabled.
func (o FeatureFlagEnvironmentOutput) OffVariation() pulumi.IntOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) pulumi.IntOutput { return v.OffVariation }).(pulumi.IntOutput)
}

// - (Optional) Whether targeting is enabled. Defaults to `false` if not set.
func (o FeatureFlagEnvironmentOutput) On() pulumi.BoolPtrOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) pulumi.BoolPtrOutput { return v.On }).(pulumi.BoolPtrOutput)
}

// List of nested blocks describing prerequisite feature flags rules. To learn more, read Nested Prequisites Blocks.
func (o FeatureFlagEnvironmentOutput) Prerequisites() FeatureFlagEnvironmentPrerequisiteArrayOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) FeatureFlagEnvironmentPrerequisiteArrayOutput { return v.Prerequisites }).(FeatureFlagEnvironmentPrerequisiteArrayOutput)
}

// List of logical targeting rules. To learn more, read Nested Rules Blocks.
func (o FeatureFlagEnvironmentOutput) Rules() FeatureFlagEnvironmentRuleArrayOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) FeatureFlagEnvironmentRuleArrayOutput { return v.Rules }).(FeatureFlagEnvironmentRuleArrayOutput)
}

// - (Optional) Set of nested blocks describing the individual user targets for each variation. To learn more, read Nested Target Blocks.
func (o FeatureFlagEnvironmentOutput) Targets() FeatureFlagEnvironmentTargetArrayOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) FeatureFlagEnvironmentTargetArrayOutput { return v.Targets }).(FeatureFlagEnvironmentTargetArrayOutput)
}

// Whether to send event data back to LaunchDarkly. Defaults to `false` if not set.
func (o FeatureFlagEnvironmentOutput) TrackEvents() pulumi.BoolPtrOutput {
	return o.ApplyT(func(v *FeatureFlagEnvironment) pulumi.BoolPtrOutput { return v.TrackEvents }).(pulumi.BoolPtrOutput)
}

type FeatureFlagEnvironmentArrayOutput struct{ *pulumi.OutputState }

func (FeatureFlagEnvironmentArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*FeatureFlagEnvironment)(nil)).Elem()
}

func (o FeatureFlagEnvironmentArrayOutput) ToFeatureFlagEnvironmentArrayOutput() FeatureFlagEnvironmentArrayOutput {
	return o
}

func (o FeatureFlagEnvironmentArrayOutput) ToFeatureFlagEnvironmentArrayOutputWithContext(ctx context.Context) FeatureFlagEnvironmentArrayOutput {
	return o
}

func (o FeatureFlagEnvironmentArrayOutput) Index(i pulumi.IntInput) FeatureFlagEnvironmentOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *FeatureFlagEnvironment {
		return vs[0].([]*FeatureFlagEnvironment)[vs[1].(int)]
	}).(FeatureFlagEnvironmentOutput)
}

type FeatureFlagEnvironmentMapOutput struct{ *pulumi.OutputState }

func (FeatureFlagEnvironmentMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*FeatureFlagEnvironment)(nil)).Elem()
}

func (o FeatureFlagEnvironmentMapOutput) ToFeatureFlagEnvironmentMapOutput() FeatureFlagEnvironmentMapOutput {
	return o
}

func (o FeatureFlagEnvironmentMapOutput) ToFeatureFlagEnvironmentMapOutputWithContext(ctx context.Context) FeatureFlagEnvironmentMapOutput {
	return o
}

func (o FeatureFlagEnvironmentMapOutput) MapIndex(k pulumi.StringInput) FeatureFlagEnvironmentOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *FeatureFlagEnvironment {
		return vs[0].(map[string]*FeatureFlagEnvironment)[vs[1].(string)]
	}).(FeatureFlagEnvironmentOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*FeatureFlagEnvironmentInput)(nil)).Elem(), &FeatureFlagEnvironment{})
	pulumi.RegisterInputType(reflect.TypeOf((*FeatureFlagEnvironmentArrayInput)(nil)).Elem(), FeatureFlagEnvironmentArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*FeatureFlagEnvironmentMapInput)(nil)).Elem(), FeatureFlagEnvironmentMap{})
	pulumi.RegisterOutputType(FeatureFlagEnvironmentOutput{})
	pulumi.RegisterOutputType(FeatureFlagEnvironmentArrayOutput{})
	pulumi.RegisterOutputType(FeatureFlagEnvironmentMapOutput{})
}
